ARG SERVICE_NAME=""
ARG CONTAINER_REGISTRY="spacefx.azurecr.io"
ARG ASPNET_VERSION=6.0.16
ARG DOTNET_VERSION=6.0
ARG SDK_VERSION=0.10.0

FROM ${CONTAINER_REGISTRY}/${SERVICE_NAME}:${SDK_VERSION}_base as svc-base
ARG CONTAINER_REGISTRY="spacefx.azurecr.io"
ARG SDK_VERSION=0.10.0


FROM ${CONTAINER_REGISTRY}/spacefx-base:${SDK_VERSION} as core
ARG CONTAINER_REGISTRY="spacefx.azurecr.io"
ARG SERVICE_NAME=""
ARG SDK_VERSION=0.10.0
ENV SERVICE_NAME=${SERVICE_NAME}
ENV DOTNET_SYSTEM_GLOBALIZATION_INVARIANT=1

# Copy the minimum files needed to run the service
COPY --from=svc-base --chmod=0755 /workspaces/${SERVICE_NAME} /workspaces/${SERVICE_NAME}
USER root
WORKDIR /workspaces/${SERVICE_NAME}
